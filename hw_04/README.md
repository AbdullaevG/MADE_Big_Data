## HW #04: Hive

Сегодня к вам пришёл менеджер с просьбой показать статистику по читателям
новостных сайтов. Как оказалось, сырые логи есть, но нужных Hive таблиц для
аналитики нет. Ваша задача - это исправить. 

В данном ДЗ нужно решить 3 задачи. Решение надо выполнить с помощью Hive.

1. **Описание данных**

   **logs_raw** (Логи запросов пользователей новостных сайтов):
     - Путь на кластере: полный датасет - /data/user_logs/user_data_M
     - Cемпл (для тестирования): /data/user_logs/user_data_S
     - Формат: текст
     - В каждой строке находятся следующие поля, разделенные знаком табуляции:
       - `ip STRING` - ip-адрес, с которого пришел запрос;
       -  `date STRING` - время запроса;
       -  `request STRING` - пришедший с ip-адреса http-запрос;
       -  `page_size INT` - размер переданной клиенту страницы в байтах;
       -  `http_status INT` - http-статус запроса;
       -  `user_agent STRING` - User Agent, информация о клиентском приложении, с которого осуществлялся запрос на сервер, в том числе информация о браузере.
   **Users** (Информация о пользователях):
     - Путь на кластере: полный датасет - /data/user_logs/user_data_M
     - Cемпл (для тестирования): /data/user_logs/user_data_S
     - Формат: текст
     - В каждой строке находятся следующие поля, разделенные знаком табуляции:
       - `ip STRING` - IP-адрес, с которого пользователь выходит в интернет;
       - `browser STRING` - браузер пользователя;
       - `sex STRING` - пол (male / female);
       - `age INT` - возраст
  **ip_regions:** (Геобаза - информация о соответствии ip-адресов регионам)
     - Путь на кластере: полный датасет - /data/user_logs/ip_data_M
     - Cемпл (для тестирования): /data/user_logs/ip_data_S
     - Формат: текст
     - каждой строке находятся следующие поля, разделенные знаком табуляции:
       - `ip STRING` - IP-адрес;
       - `region STRING` - регион;

2. **Задача 1: создание таблиц в Hive (Task ID: hive.ddl)**

   Создайте внешние (EXTERNAL) таблицы по исходным данным:
   - logs_raw - логи пользователей;
   - users - таблица с информацией о пользователях;
   - ip_regions - таблица с IP и регионами;
   - logs - партиционированная таблица с логами (Из таблицы логов перенесите данные в другую таблицу, партиционированную по
датам – одна партиция на каждый день)

3. **Задача 2: горячий денек (Task ID: hive.hot_day)**

   Напишите запрос, который считает, какое количество посещений новостных сайтов
было в разрезе дней. Полученные результаты отсортируйте (ORDER BY) по убыванию
популярности. На экран выведите TOP-10 самых “горячих” дней с точки зрения
нагрузки на инфраструктуру новостных сервисов в формате: `день <tab> число посещений`

4. **Задача 3: identify browser sex (Task ID: hive.sex_browser)**

   Напишите запрос, который считает число употреблений браузера мужчинами и
женщинами. Считаем статистику по таблице logs, но информацию о браузере берем
из таблицы users . Выведите произвольные 10 записей (4 LIMIT 10) в формате: `браузер <tab> посещаемость мужчинами <tab> посещаемость женщинами`
